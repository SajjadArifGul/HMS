@model HMS.Areas.Dashboard.ViewModels.UserRolesModel

@if (Model != null)
{
	<div class="modal-content">
		<div class="modal-header">
			<h5 class="modal-title">
				<span>User Roles</span>
			</h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<div class="modal-body">
			@if (Model.UserRoles != null && Model.UserRoles.Count() > 0)
			{
			<table class="table">
				<thead>
					<tr>
						<th colspan="2">
							Current User Roles
						</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var role in Model.UserRoles)
					{
						<tr>
							<td>
								@role.Name
							</td>
							<td>
								<button data-href="@Url.Action("DeleteUserRole", "Users", new { ID = role.Id })" type="button" class="data-btn btn btn-danger" data-toggle="modal" data-target="#actionModal"><i class="fas fa-trash-alt mr-1"></i> Delete</button>
							</td>
						</tr>
					}
				</tbody>
			</table>
			}
			else
			{
				<div class="alert alert-warning" role="alert">
					This user has no roles.
				</div>
			}
			<hr />

			@if (Model.Roles != null && Model.Roles.Count() > 0)
			{
				<table class="table">
					<thead>
						<tr>
							<th colspan="2">
								Assign New Roles
							</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var role in Model.Roles)
						{
							<tr>
								<td>
									@role.Name
								</td>
								<td>
									<button data-href="@Url.Action("AssignUserRole", "Users", new { ID = role.Id })" type="button" class="data-btn btn btn-success" data-toggle="modal" data-target="#actionModal"><i class="fas fa-trash-alt mr-1"></i> Assign</button>
								</td>
							</tr>
						}
					</tbody>
				</table>
			}
			else
			{
				<div class="alert alert-warning" role="alert">
					No roles available.
				</div>
			}
		</div>
		<div class="modal-footer">
			<button id="actionButton" type="button" class="btn btn-primary"><i class="fas fa-save mr-1"></i> Save</button>
			<button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fas fa-times mr-1"></i> Close</button>
		</div>
	</div>
}

<script>
	$("#actionButton").click(function () {
		$.ajax({
			url: '@Url.Action("Action", "Users")',
			type: "post",
			data: $("#actionForm").serialize()
		})
		.done(function (response) {
			if(response.Success)
			{
				location.reload();
			}
			else {
				$(".errorDiv").html(response.Message);
			}
		});
	});
</script>
